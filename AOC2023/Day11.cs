using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Linq;
using System.Text;

namespace AOC2023
{
    public class Day11
    {

        public static void Main()
        {
            var input = @"...........#...............................................#...................#.....#.............#........................................
..................#..................................#..................#.....................#................#...................#.......#
....#........................................................................................................................#..............
..............................#........#..................................................#.................................................
.............#........#...........................#..........................#..............................#...............................
......................................................................................................#.............#.......................
...........................................................#......................#........................................#................
.........#.....................................#.......................#..................................................................#.
..................#.......#....................................................................#...................................#........
#..........................................#...............................................................#......#.........................
..................................................#.........................................................................................
..............................................................#.....#....................#..................................................
......#..............................#......................................................................................................
...............................................#......#.................#..........#................................#.......................
..............................................................................#........................#.................................#..
.............#....................................................................................#............................#............
.......................#.............................................#......................................................................
...............................#....................#.........................................#.....................................#.......
..........#.................................................................................................#...............................
..........................................................................#.......#..........................................#..............
...#..............................#............................#....................................#..................#....................
..................#..........................#....................................................................................#.........
.........................#.........................#.......#..........#...................#.................................................
........#.....#.............................................................#...................#........#..................................
..............................#.........#......................................................................................#......#.....
......................................................#......................................................#..............................
....................................................................................................#.......................................
.............................................................#.......#.....................#.......................#...............#........
..#...................#......................................................................................................#..............
......................................#..........................#.....................#....................................................
.............#..............................................................................................................................
...............................#.................#.........................#...................#..............#.............................
........................#...........................................................#................................................#......
........................................#................................................#..........#......................................#
......................................................................#............................................#......#.................
............................................................................................................................................
...........#................................................#.................................#.............................................
.....................................#......#...............................................................................................
....#............#..................................................#.............#....................#..........................#.........
............................................................................................................................................
.......................#.....#...........#............................................................................#..................#..
.......#................................................#...............................#......#............................................
...................................#...........................#...........#....................................#...........................
#.............................................................................................................................#.............
...............................#...........................#......................#.......................#.................................
............#.............#..................#..............................................................................................
....................................................#...............#........#.........#...........................................#........
...............................................................................................................#......#...................#.
.......#.............#..............#.......................................................................................................
.............................................................................................................................#..............
............................................................................................................................................
.................#............#...............................#.......#......................#..........#...............#...................
........................#..........................................................#................................................#.......
.#.................................................#........................................................................................
...........#.................................#.....................................................#........................................
......................................#.....................................................................#......#........................
.......#............#...................................................#.............................................................#.....
...............#.....................................#........#...............#............................................#...............#
...................................................................#....................#...................................................
.................................................#..........................................................................................
..................#........................#..................................................#.......#...............#.....................
............................................................................................................................................
......#...........................#..............................#..........................................................#...............
...........................................................#.....................................................#..........................
...........................#........................#..............................................................................#......#.
...........#..............................................................#..................................#..............................
..........................................#.................................................................................................
...#..........................................................#.........................#.......................................#...........
........................................................#......................#..........................#..........................#......
.......................#.............................................#.............................#........................................
.......................................................................................................................#....................
......#......#....................#.........................................................................................................
...............................................................#............#......#.....#..............#..........#..........#.............
.#...............#.....................#......#.....#.......................................................................................
...................................................................#.........................#...........................................#..
............................................................................................................................................
...........................................#...........................#..............................#.....................................
......#....................................................#....................#..............................#....................#.......
......................#.......#....................#........................................................................................
............#.................................#................#...............................#....................#.......................
.......................................#.................................................................................................#..
............................................................................................................................................
...#.....................#.........................................#...................#....................#....................#..........
.................#..............#.....................................................................................................#.....
...........................................................................#....................#.................#.........................
.......#...................................................................................#................................................
............#..........#....................................................................................................................
......................................................................#.......#.............................................#...............
........................................................................................................#...................................
....#.........................................................#.............................................................................
..........#....................#....................#......................#..................#......................#......................
#...............#...................#.........#..........#...................................................#..............................
...................................................................................................................................#........
............................#.........................................................#.....................................................
..........................................#...................................#.............................................................
...#.................................................#.................................................................#.....#.............#
......................#............#................................#...............................#.............#..................#......
.........................................................................................................#..................................
............#.....................................#.......................#...............#...................#.............................
.#....................................#.....#....................................................................................#..........
........#........................................................#..........................................................................
...................#........#............................#.............................#..............................#.....................
..............................................................................................................................#.............
....................................................#..........................#............................................................
........................#.......................................................................#............#............................#.
..........................................#................................................................................#................
..................#..........................................#.........................................#..............................#.....
.............#...................................#..................#........................#..............................................
.............................#...........................#......................#..................#........................................
...................................#................................................................................#........#..............
......#.................................................................#..............#....................................................
.................#.........................................................................................#................................
............................................................................................................................................
...........................#...........#.........................................#...................#................#............#.....#..
.#..........................................................................................#...............................................
.....................#............................#.....#...................#....................................#..........................
.............................................#.................#......................#.....................................................
...................................#................................#.......................................................................
......................................................................................................#.....................................
......#.....#....................................................................................#.............................#.....#......
.......................#...................#........#......................................#................................................
.............................................................................................................#..............................
#................#..........#........#..........#.......#......#........................................................................#...
.....................................................................#.........#........#.....#......#.................#....................
................................#...........................................................................................................
.........................#..............#....................................................................................#..............
..........#.................................................................................................................................
..........................................................................................#........#........................................
.................#...................#..........#.......#......#...................................................#...............#........
............................................................................................................................................
.............................#................................................................#.............................................
...#.......#................................................................#........#...................#............#.........#..........#
........................#.................#................#................................................................................
.....................................................................#.....................................................#................
....................................................#............................#......................................................#...
.#..........................................................................................#......#...............#..............#.........
............................................................................................................................................
..........#........#............#.........................................................................#.................................
........................................................#..........#........................................................................
.....#.............................................#.........#....................#.............................#.........#.................";
            var sample = @"...#......
.......#..
#.........
..........
......#...
.#........
.........#
..........
.......#..
#...#.....";
            part1(sample);
            part2(sample, 10);
            part2(sample, 100);
            part1(input);
            part2(input, 1_000_000);

        }
        private static void part2(string input, int expansion)
        {
            long sum = 0;
            var inputs = input.Split(new char[] { '\n', '\r' }, StringSplitOptions.RemoveEmptyEntries).ToArray();
            int m = inputs.Length, n = inputs[0].Length;
            var rowHasGalaxy = new bool[m];
            var colHasGalaxy = new bool[n];
            for (int r = 0; r < m; r++)
            {
                for (int c = 0; c < n; c++)
                {
                    if (inputs[r][c] == '#')
                    {
                        rowHasGalaxy[r] = true;
                        colHasGalaxy[c] = true;
                    }
                }
            }
            var galaxies = new List<(int r, int c)>();
            int reelRow = 0, reelCol = 0;
            for (int r = 0; r < m; r++, reelRow++)
            {
                if (!rowHasGalaxy[r])
                {
                    reelRow += expansion - 1;
                    continue; // no galaxy in the row
                }
                reelCol = 0;
                for (int c = 0; c < n; c++, reelCol++)
                {
                    if (!colHasGalaxy[c])
                    {
                        reelCol += expansion - 1; continue;
                    }
                    if (inputs[r][c] == '#')
                    {
                        galaxies.Add((reelRow, reelCol));
                    }
                }
            }
            int g = galaxies.Count;
            for (int i = 0; i < g; i++)
            {
                for (int j = i + 1; j < g; j++)
                {
                    sum += Math.Abs(galaxies[i].r - galaxies[j].r) + Math.Abs(galaxies[i].c - galaxies[j].c);
                }
            }
            Console.WriteLine($"2nd part answer with {expansion} as expansion is {sum}");
        }

        private static void part1(string input)
        {
            long sum = 0;
            var inputs = input.Split(new char[] { '\n', '\r' }, StringSplitOptions.RemoveEmptyEntries).ToArray();
            int m = inputs.Length, n = inputs[0].Length;
            var rowHasGalaxy = new bool[m];
            var colHasGalaxy = new bool[n];
            for (int r = 0; r < m; r++)
            {
                for (int c = 0; c < n; c++)
                {
                    if (inputs[r][c] == '#')
                    {
                        rowHasGalaxy[r] = true;
                        colHasGalaxy[c] = true;
                    }
                }
            }
            var galaxies = new List<(int r, int c)>();
            int reelRow = 0, reelCol = 0;
            for (int r = 0; r < m; r++, reelRow++)
            {
                if (!rowHasGalaxy[r])
                {
                    reelRow++;
                    continue; // no galaxy in the row
                }
                reelCol = 0;
                for (int c = 0; c < n; c++, reelCol++)
                {
                    if (!colHasGalaxy[c])
                    {
                        reelCol++; continue;
                    }
                    if (inputs[r][c] == '#')
                    {
                        galaxies.Add((reelRow, reelCol));
                    }
                }
            }
            int g = galaxies.Count;
            for (int i = 0; i < g; i++)
            {
                for (int j = i + 1; j < g; j++)
                {
                    sum += Math.Abs(galaxies[i].r - galaxies[j].r) + Math.Abs(galaxies[i].c - galaxies[j].c);
                }
            }
            Console.WriteLine($"1st part answer is {sum}");
        }


    }

}